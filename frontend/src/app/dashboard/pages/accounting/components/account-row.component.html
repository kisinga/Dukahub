<!-- Parent Account Row -->
<tr
  [class.bg-primary/10]="selectedAccount()?.id === account().id"
  class="cursor-pointer hover:bg-base-200"
  (click)="onAccountClick(account())"
>
  <td class="font-mono" [style.padding-left.px]="level() * 24">
    <div class="flex items-center gap-2">
      @if (account().children.length > 0) {
      <button
        (click)="toggleExpanded(); $event.stopPropagation()"
        class="btn btn-ghost btn-xs btn-square"
      >
        @if (isExpanded()) {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-4 w-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>
        } @else {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-4 w-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
        }
      </button>
      } @else {
      <span class="w-6"></span>
      }
      <span>{{ account().code }}</span>
      @if (account().isParent) {
      <span class="badge badge-xs badge-primary">Parent</span>
      }
    </div>
  </td>
  <td class="font-semibold">{{ account().name }}</td>
  <td>
    <span
      class="font-semibold font-mono"
      [class.text-success]="getDisplayBalance()(account()) >= 0"
      [class.text-error]="getDisplayBalance()(account()) < 0"
    >
      {{ formatCurrency()(getDisplayBalance()(account())) }}
    </span>
  </td>
  <td class="text-right">
    <button
      class="btn btn-sm btn-ghost"
      (click)="onViewTransactions(account(), $event)"
    >
      View Transactions
    </button>
  </td>
</tr>
<!-- Child Rows (when expanded) -->
@if (isExpanded() && account().children.length > 0) {
@for (child of account().children; track child.id) {
<app-account-row
  [account]="child"
  [selectedAccount]="selectedAccount()"
  [formatCurrency]="formatCurrency()"
  [getDisplayBalance]="getDisplayBalance()"
  [level]="level() + 1"
  (accountSelect)="onAccountClick($event)"
  (viewTransactions)="onViewTransactions($event, $any($event))"
/>
}
}

